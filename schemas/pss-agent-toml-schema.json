{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PSS Agent TOML Configuration",
  "description": "Schema for .agent.toml files generated by /pss-setup-agent. Defines the recommended skills, complementary agents, and metadata for a profiled agent.",
  "version": "1.0",
  "type": "object",
  "required": ["agent", "skills"],
  "properties": {
    "agent": {
      "type": "object",
      "description": "Agent identification and source metadata",
      "required": ["name", "path"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Agent name (kebab-case, e.g., 'security-auditor')",
          "pattern": "^[a-z0-9][a-z0-9_-]*$"
        },
        "source": {
          "type": "string",
          "description": "How the agent was specified: 'path' for direct file path, 'plugin:<name>' for plugin notation",
          "examples": ["path", "plugin:my-plugin"]
        },
        "path": {
          "type": "string",
          "description": "Absolute path to the agent.md definition file"
        }
      },
      "additionalProperties": false
    },
    "requirements": {
      "type": "object",
      "description": "Design requirements context used for profiling (empty if none provided)",
      "properties": {
        "files": {
          "type": "array",
          "description": "Basenames of requirement files used for profiling",
          "items": { "type": "string" },
          "default": []
        },
        "project_type": {
          "type": "string",
          "description": "Detected project type from requirements (e.g., 'web-app', 'cli-tool', 'mobile-app', 'library')",
          "default": ""
        },
        "tech_stack": {
          "type": "array",
          "description": "Key technologies detected from requirements",
          "items": { "type": "string" },
          "default": []
        }
      },
      "additionalProperties": false
    },
    "skills": {
      "type": "object",
      "description": "Tiered skill recommendations, ordered by relevance within each tier",
      "required": ["primary", "secondary", "specialized"],
      "properties": {
        "primary": {
          "type": "array",
          "description": "Core skills the agent needs for daily work (max 7). Score >= 60% of max.",
          "items": { "type": "string" },
          "maxItems": 7
        },
        "secondary": {
          "type": "array",
          "description": "Useful skills for common tasks (max 12). Score 30-59% of max.",
          "items": { "type": "string" },
          "maxItems": 12
        },
        "specialized": {
          "type": "array",
          "description": "Niche skills for specific situations (max 8). Score 15-29% of max.",
          "items": { "type": "string" },
          "maxItems": 8
        },
        "excluded": {
          "type": "object",
          "description": "Skills considered but excluded. Keys are skill names, values are exclusion reasons. Stored as TOML comments in the file (not parsed, for human reference).",
          "additionalProperties": { "type": "string" }
        }
      },
      "additionalProperties": false
    },
    "agents": {
      "type": "object",
      "description": "Complementary agents that work well with this one",
      "properties": {
        "recommended": {
          "type": "array",
          "description": "Agent names that complement this agent's workflow",
          "items": { "type": "string" },
          "default": []
        }
      },
      "additionalProperties": false
    },
    "mcp": {
      "type": "object",
      "description": "MCP servers that enhance this agent's capabilities (future)",
      "properties": {
        "recommended": {
          "type": "array",
          "items": { "type": "string" },
          "default": []
        }
      },
      "additionalProperties": false
    },
    "hooks": {
      "type": "object",
      "description": "Hooks relevant to this agent's workflow (future)",
      "properties": {
        "recommended": {
          "type": "array",
          "items": { "type": "string" },
          "default": []
        }
      },
      "additionalProperties": false
    },
    "lsp": {
      "type": "object",
      "description": "LSP servers relevant to this agent (future)",
      "properties": {
        "recommended": {
          "type": "array",
          "items": { "type": "string" },
          "default": []
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false,

  "examples": [
    {
      "agent": {
        "name": "security-auditor",
        "source": "path",
        "path": "/path/to/agents/security-auditor.md"
      },
      "requirements": {
        "files": ["prd.md", "tech-spec.md"],
        "project_type": "web-app",
        "tech_stack": ["python", "django", "postgresql"]
      },
      "skills": {
        "primary": ["security", "aegis", "code-review"],
        "secondary": ["exhaustive-testing", "dead-code", "debug-hooks"],
        "specialized": ["tdd", "profiler"],
        "excluded": {}
      },
      "agents": {
        "recommended": ["sleuth", "e2e-tester"]
      },
      "mcp": { "recommended": [] },
      "hooks": { "recommended": [] },
      "lsp": { "recommended": [] }
    }
  ]
}
