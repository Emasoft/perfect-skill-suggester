# Scoring Reference, Example & Troubleshooting

## Table of Contents

- [Scoring Reference](#scoring-reference)
- [Troubleshooting](#troubleshooting)
- [Complete Example](#complete-example)

---

## Scoring Reference

The Rust binary uses weighted scoring to generate candidates:

| Evidence Type | Weight | Description |
|--------------|--------|-------------|
| `keyword` | +2 | Direct keyword match |
| `intent` | +4 | Intent category match |
| `pattern` | +3 | Regex pattern match |
| `directory` | +5 | Working directory match |
| `path` | +4 | File path pattern match |
| `first_match` | +10 | First match bonus |
| `original_bonus` | +3 | Match on original (uncorrected) query |

**Tier thresholds** (relative to max score):
- **Primary** (max 7): score >= 60% of maximum
- **Secondary** (max 12): score 30-59% of maximum
- **Specialized** (max 8): score 15-29% of maximum

**Remember**: These scores are heuristic starting points. The AI agent's evaluation in Phase 3 may promote low-scored elements or demote high-scored ones based on actual content analysis.

---

## Troubleshooting

| Problem | Solution |
|---------|----------|
| "Skill index not found" | Run `/pss-reindex-skills` to build the index |
| "Binary not found" | Build with `cd rust/skill-suggester && cargo build --release` |
| "Unsupported platform" | Check `platform.system()` and `platform.machine()` match PLATFORM_MAP |
| "TOML validation failed" | Read validator errors — common: missing quotes, duplicate skills across tiers |
| "No candidates returned" | Agent description too vague — add more specific duties and domains |
| "All candidates low confidence" | Requirements may not match indexed keywords — try more specific terms |
| Empty `[commands]` or `[rules]` | These types may not be indexed yet — run `/pss-reindex-skills` |

---

## Complete Example

**Input**: Profile a "frontend-developer" agent for a React/Next.js e-commerce project.

**Agent file** (`agents/frontend-developer.md`):
```markdown
---
name: frontend-developer
description: Build React components, implement responsive layouts, and handle client-side state management
tools: [Bash, Read, Write, Edit, Grep, Glob, WebSearch, WebFetch, Task]
---
# Frontend Developer
Builds UI components, manages state, handles routing and data fetching.
```

**Requirements** (`prd.md`): "E-commerce platform with React 19, Next.js 15, Tailwind CSS, PostgreSQL, Stripe payments, i18n support."

**Command**:
```
/pss-setup-agent agents/frontend-developer.md --requirements prd.md
```

**Profiler reasoning** (Phase 3):
- Binary returned `building-with-bun` (HIGH) — Bun is the standard JS runtime, matches Next.js. KEEP as primary.
- Binary returned `jest-testing` (MEDIUM) AND `vitest-testing` (MEDIUM) — CONFLICT: Requirements use Next.js 15 which uses Turbopack, Vitest integrates better. KEEP vitest, EXCLUDE jest.
- Binary returned `vue-frontend` (LOW) — CONFLICT: Requirements specify React. REMOVE.
- Requirements mention "i18n" but no i18n skill was returned — GAP. Search index for "internationalization" -> found `i18n-react` skill. ADD to secondary.
- `chrome-devtools` appears as both skill and MCP — OVERLAP: MCP provides actual DevTools protocol access, skill provides instructions. KEEP both (complementary).

**Output** (`team/agents-cfg/frontend-developer.agent.toml`):
```toml
# Auto-generated by PSS Agent Profiler
# Agent: frontend-developer
# Generated: 2026-02-27T10:30:00+00:00
# Requirements: prd.md

[agent]
name = "frontend-developer"
source = "path"
path = "/abs/path/to/agents/frontend-developer.md"

[requirements]
files = ["prd.md"]
project_type = "web-app"
tech_stack = ["react", "nextjs", "tailwind", "postgresql", "stripe"]

[skills]
primary = ["building-with-bun", "css-to-svg-conversion", "development-standards"]
secondary = ["exhaustive-testing", "handle-deprecation-warnings", "dependency-management", "git-workflow", "i18n-react"]
specialized = ["accessibility-compliance", "responsive-design"]

[skills.excluded]
# "jest-testing" = "Excluded: Vitest preferred for Next.js 15 / Turbopack"
# "vue-frontend" = "Excluded: Conflicts with React (requirements specify React 19)"
# "angular-dev" = "Excluded: Conflicts with React (requirements specify React 19)"

[agents]
recommended = ["ui-ux-designer", "e2e-tester"]

[commands]
recommended = ["commit", "describe-pr"]

[rules]
recommended = ["claim-verification", "observe-before-editing"]

[mcp]
recommended = ["chrome-devtools"]

[hooks]
recommended = []

[lsp]
recommended = ["typescript-lsp"]
```
